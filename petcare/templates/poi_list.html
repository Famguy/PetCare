<!DOCTYPE>
<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
        <title>Points of Interest</title>
        <style>
             html, body {
            margin: 0;
            padding: 0;
          }
            #map-canvas {
                height: 70%;
                margin: 5%;
            }
        </style>
    </head>

    <body>

        <p> Showing results for {{place}}</p>
        <div id="map-canvas"></div>
        {% for poi in pois %}
            <div class = "entry">

            </div>
        {% endfor %}
        <dl>
            {% for poi in pois %}
                <dt>{{ poi.name }}</dt>
                <dd>{{ poi.latitude }}</dd>
            {% endfor %}
        </dl>

        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA0tl-yTrvyi_9UESPKQ27Ny4L0ONoktj8"></script>

        <script>
            function initialize() {
                var map = new google.maps.Map(document.getElementById('map-canvas'));
                var bounds = new google.maps.LatLngBounds();

                function addMarker(lat, lng, title, info) {
                    var position = new google.maps.LatLng(lat, lng);
                    var contentString = '<div id="content">'+
                                        '<div id="siteNotice">'+
                                        '</div>'+
                                        '<h3 id="firstHeading" class="firstHeading">'+title+'</h3>'+
                                        '<div id="bodyContent">'+
                                        '<p>'+info+'</p>'+
                                        '</div>'+
                                        '</div>';
                    var infowindow = new google.maps.InfoWindow({
                        content: contentString
                    });                   
                    var marker = new google.maps.Marker({
                        position: position,
                        map: map,
                        title: title
                    });
                    marker.addListener('click', function() {
                        map.setZoom(map.getZoom() + 1);
                        map.setCenter(marker.getPosition());
                    });
                    marker.addListener('mouseover', function() {
                        infowindow.open(map, marker);
                    });
                    marker.addListener('mouseout', function() {
                        infowindow.close();
                    });
                    bounds.extend(position);
                }

                {% for poi in pois %}
                    addMarker({{ poi.latitude }}, {{ poi.longitude }}, "{{ poi.name }}","{{ poi.address }}");
                {% endfor %}

                map.fitBounds(bounds);
            }

            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
    </body>
</html>
